# 小车 #

## 研发进度 ##

目前实现了数据包的接收。		--2023-01-19-01-05--

实现了从接收缓冲区中提取一帧数据包          --2023-01-19-16-37--

## 电机 ##

## 蓝牙 ##

蓝牙需要接收数据包，先写接收一个数据包的中断服务函数。

首先修改蓝牙对应的串口三的接收标志位，设定最高位为接收成功一帧数据包，次高位为接收到数据，bit13~12为接收缓冲区溢出次数，剩下的为接收字符数目。这样修改还不能完全满足判定接收成功一帧数据，还应该在中断服务函数中添加一个判断一帧数据包接收完整程度的标志位，即在中断服务函数中添加一个uint8_t类型的静态本地变量。

## 数据包 ##

数据包分为接收数据包和发送数据包两个部分。

### 接收数据包和发送数据包简介 ###

接收数据包用于单片机接收上位机发送过来的指令。它的结构如下图所示：

![接收数据包](./picts/%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE%E5%8C%85.jpg)

接收数据包的第一个字节是 `包头字节`，最后一个字节是 `包尾字节`，在包头字节和包尾字节中间有原始数据和校验和，校验和是原始数据相加后的低8位。

发送数据包用于单片机发送状态给上位机。它的结构如下图所示：

![发送数据包](./picts/%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE%E5%8C%85.jpg)

发送数据包的第一个字节是 `包头字节`，最后一个字节是 `包尾字节`，在包头字节和包尾字节中间有原始数据和校验和，校验和是原始数据相加后的低8位。

### 接收数据包解码 ###

#### 验证数据包的完整性 ####

我们首先得验证接收数据包是否正确，验证方法就是利用数据包中的校验和，如果校验和准确，则认为数据包正确。

#### 解码数据包 ####

#### 执行相应动作 ####

### 发送数据包编码 ###
